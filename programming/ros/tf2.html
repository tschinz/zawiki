

<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Transform Frames &#8212; Zawiki</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="../../_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/theme_overrides.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/copy_button.css" type="text/css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/default.js"></script>
    <script src="../../_static/wavedrom.min.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="../../_static/favicon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Scala" href="../scala/index.html" />
    <link rel="prev" title="RViz" href="rviz.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main">
<div class="container-xl">

    
    <a class="navbar-brand" href="../../index.html">
      <img src="../../_static/logo.svg" class="logo" alt="logo">
    </a>
    
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-menu" aria-controls="navbar-menu" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar-menu" class="col-lg-9 collapse navbar-collapse">
      <ul id="navbar-main-elements" class="navbar-nav mr-auto">
        
        
        <li class="nav-item ">
            <a class="nav-link" href="../../os/index.html">OS</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../../tools/index.html">Tools</a>
        </li>
        
        <li class="nav-item active">
            <a class="nav-link" href="../index.html">Programming</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../../boards/index.html">Dev Boards</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../../writing/index.html">Writing</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../../multimedia/index.html">Multimedia</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../../security/index.html">Security</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../../about/index.html">About</a>
        </li>
        
        
        <li class="nav-item">
            <a class="nav-link nav-external" href="https://github.com/tschinz/config">Config repo<i class="fas fa-external-link-alt"></i></a>
        </li>
        
      </ul>


      <form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Don't panic, search" aria-label="Don't panic, search" autocomplete="off" >
</form>
      

      <ul class="navbar-nav">
        
          <li class="nav-item">
            <a class="nav-link" href="https://github.com/tschinz/zawiki" target="_blank" rel="noopener">
              <span><i class="fab fa-github-square"></i></span>
            </a>
          </li>
        
        
          <li class="nav-item">
            <a class="nav-link" href="https://twitter.com/tschinz" target="_blank" rel="noopener">
              <span><i class="fab fa-twitter-square"></i></span>
            </a>
          </li>
        
      </ul>
    </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
          <div class="col-12 col-md-3 bd-sidebar">



<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">

  <div class="bd-toc-item active">
  

  <ul class="nav bd-sidenav">
      
      
      
      
      
      
        
          
              <li class="">
                  <a href="../ahk/index.html">AHK</a>
              </li>
          
        
          
              <li class="">
                  <a href="../c_cpp/index.html">C / C++</a>
              </li>
          
        
          
              <li class="">
                  <a href="../licenses/index.html">Licenses</a>
              </li>
          
        
          
              <li class="">
                  <a href="../make/index.html">Make</a>
              </li>
          
        
          
              <li class="">
                  <a href="../python/index.html">Python</a>
              </li>
          
        
          
              <li class="">
                  <a href="../regex/index.html">RegEx</a>
              </li>
          
        
          

              <li class="active">
                  <a href="index.html">ROS</a>
                  <ul>
                  
                      <li class="">
                          <a href="basics.html">Basics</a>
                      </li>
                  
                      <li class="">
                          <a href="books-summary.html">Books summary</a>
                      </li>
                  
                      <li class="">
                          <a href="catkin_tools.html">Catkin Tools</a>
                      </li>
                  
                      <li class="">
                          <a href="commands.html">Commandline Commands</a>
                      </li>
                  
                      <li class="">
                          <a href="install.html">Installation</a>
                      </li>
                  
                      <li class="">
                          <a href="launch.html">Launch</a>
                      </li>
                  
                      <li class="">
                          <a href="lidar-driver.html">Lidar Driver</a>
                      </li>
                  
                      <li class="">
                          <a href="packages.html">Packages</a>
                      </li>
                  
                      <li class="">
                          <a href="packages-ext.html">External Packages and Nodes</a>
                      </li>
                  
                      <li class="">
                          <a href="rviz.html">RViz</a>
                      </li>
                  
                      <li class="active">
                          <a href="">Transform Frames</a>
                      </li>
                  
                  </ul>
              </li>
          
        
          
              <li class="">
                  <a href="../scala/index.html">Scala</a>
              </li>
          
        
          
              <li class="">
                  <a href="../spinal/index.html">Spinal HDL</a>
              </li>
          
        
          
              <li class="">
                  <a href="../swift/index.html">Swift</a>
              </li>
          
        
          
              <li class="">
                  <a href="../tcl_tk_do/index.html">Tcl-Tk</a>
              </li>
          
        
          
              <li class="">
                  <a href="../vhdl/index.html">VHDL</a>
              </li>
          
        
      
      
      
      
      
      
      
      
      
      
      
      
    </ul>

</nav>
          </div>
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
              

<nav id="bd-toc-nav">
    <ul class="nav section-nav flex-column">
    
    </ul>
</nav>



<div class="tocsection editthispage">
    <a href="https://github.com/tschinz/zawiki/edit/master/source/programming/ros/tf2.rst">
        <i class="fas fa-pencil-alt"></i> Edit this page
    </a>
</div>

              
          </div>
          

          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <div class="section" id="transform-frames">
<h1>Transform Frames<a class="headerlink" href="#transform-frames" title="Permalink to this headline">¶</a></h1>
<p>A frame in the ROS language is a specific coordinate system in the space. ROS abstracts elements of a robot as coordinates frames. Each physical part of a robot that has a particular meaning will most likely have its own frame :</p>
<ul class="simple">
<li><p>a sensor : <em>laser_frame</em></p></li>
<li><p>an arm : <em>left_arm_frame</em></p></li>
</ul>
<p>It is up to the programmer to create frames where it is necessary, but some frames are already defined by ROS (see below).</p>
<p>Each frame has it own origin and coordinate system :</p>
<div class="figure align-center" id="id1">
<img alt="coordinate frame axis" src="../../_images/tf_origin.png" />
<p class="caption"><span class="caption-text">coordinate frame axis</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</div>
<p>To keep trace of the frames in the whole coordinate system, they must all refer to a main frame. Knowing the position of the main frame and the relative positions of all the other frames, ROS is able to know the exact position of each frame all continuously.</p>
<p>The TF2 package tracks the coordinate frames. There are several predefined frames :</p>
<ul class="simple">
<li><p><em>world</em> : kind of the parent of all the frames, does not move, there is only one single <em>world</em></p></li>
<li><p><em>map</em> : child of <em>world</em>, can be freely fixed in the world frame, does not move compared to the <em>world</em>, but it can be several <em>map</em> frames in a <em>world</em> (usually one <em>map</em> per robot)</p></li>
<li><p><em>odom</em> : child of <em>map</em>, fixed at the start point of the robot in the <em>map</em> frame, does not move compared to <em>world</em> and <em>map</em></p></li>
<li><p><em>base_link</em> : kind of the reference frame of a robot, it is moving in <em>odom</em>, therefore moving in <em>map</em> and <em>world</em></p></li>
<li><p>…</p></li>
</ul>
<p>The TF tree shows the relations between the frames :</p>
<div class="figure align-center" id="id2">
<img alt="tf tree" src="../../_images/tf_tree.png" />
<p class="caption"><span class="caption-text">tf tree</span><a class="headerlink" href="#id2" title="Permalink to this image">¶</a></p>
</div>
<p>One can create coordinate frames for each part of the robot that needs to be tracked, for example :</p>
<ul class="simple">
<li><p><em>scanner_frame</em> : position of the scanner on a robot, somehow linked to the <em>base_link</em></p></li>
<li><p><em>wheels_frame</em> : position of the wheels on a robot, somehow linked to the <em>base_link</em></p></li>
</ul>
<p>The links between the <em>base_link</em> and the other frames can be direct, or they can be relative to it via other frames.</p>
<p>They are linked together by TF (transform frames). TF can be either static, which means that the relation between two frames will never change (for example two sensors being fixed 1 meter away), or dynamic when the relation evolves in the time (for example the arm of a robot compared to its head).</p>
<p>Let us use the example our two LIDAR sensor : they are oriented in the same way, they are on the same table, the only difference being there is 2.15 meter between them. For this example, they will never move nor rotate. We can use the node <em>static_transform_publisher</em> to inform other nodes that will use their data of their relative position. We will also fix them in the <em>world</em>, <em>map</em> and <em>base_link</em> frame.</p>
<p>Since the <em>base_link</em> frame will not move neither, it will also be fixed to the <em>map</em> by a static transform. The static transformations are called as a node from a launcher :</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;launch&gt;</span>
      <span class="c">&lt;!-- From world to map, same origin --&gt;</span>
      <span class="nt">&lt;node</span> <span class="na">pkg=</span><span class="s">&quot;tf2_ros&quot;</span> <span class="na">type=</span><span class="s">&quot;static_transform_publisher&quot;</span> <span class="na">name=</span><span class="s">&quot;world_to_map&quot;</span>
            <span class="na">args=</span><span class="s">&quot;0 0 0 0 0 0 /world /map&quot;</span> <span class="nt">/&gt;</span>

      <span class="c">&lt;!-- From map to base_link, fixed in this case --&gt;</span>
      <span class="nt">&lt;node</span> <span class="na">pkg=</span><span class="s">&quot;tf2_ros&quot;</span> <span class="na">type=</span><span class="s">&quot;static_transform_publisher&quot;</span> <span class="na">name=</span><span class="s">&quot;map_to_base_link&quot;</span>
            <span class="na">args=</span><span class="s">&quot;0 0 0 0 0 0 /map /base_link&quot;</span> <span class="nt">/&gt;</span>

      <span class="c">&lt;!-- From base_link to laser_frame1, position of the first lidar --&gt;</span>
      <span class="nt">&lt;node</span> <span class="na">pkg=</span><span class="s">&quot;tf2_ros&quot;</span> <span class="na">type=</span><span class="s">&quot;static_transform_publisher&quot;</span> <span class="na">name=</span><span class="s">&quot;base_link_to_lidar1&quot;</span>
            <span class="na">args=</span><span class="s">&quot;0 0 0 0 0 0 /base_link /lidar1_frame&quot;</span> <span class="nt">/&gt;</span>

      <span class="c">&lt;!-- From base_link to laser_frame2, position of the second lidar --&gt;</span>
      <span class="nt">&lt;node</span> <span class="na">pkg=</span><span class="s">&quot;tf2_ros&quot;</span> <span class="na">type=</span><span class="s">&quot;static_transform_publisher&quot;</span> <span class="na">name=</span><span class="s">&quot;base_link_to_lidar2&quot;</span>
            <span class="na">args=</span><span class="s">&quot;-2.15 -0.01 0 0 0 0 /base_link /lidar2_frame&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/launch&gt;</span>
</pre></div>
</div>
<p>Which will produce the following TF tree :</p>
<div class="figure align-center" id="id3">
<img alt="lidar tf tree" src="../../_images/tf_tree_lidar.png" />
<p class="caption"><span class="caption-text">lidar tf tree</span><a class="headerlink" href="#id3" title="Permalink to this image">¶</a></p>
</div>
<p>The arguments are :</p>
<ul class="simple">
<li><p>translations in X, Y, Z</p></li>
<li><p>rotations around X, Y, Z</p></li>
<li><p>parent <em>frame_id</em></p></li>
<li><p>child <em>frame_id</em></p></li>
</ul>
<p>Each topic has a reference frame. This means that each message being published on a topic kind of contains the position “from where it comes”. This is the <em>frame_id</em> parameter. The node that will published the data of the LIDAR shall publish them with the right <em>frame_id</em>, otherwise the TF tree will not be able to link all the TF together.</p>
<p>Documentation about frames and transformations can be found there :</p>
<ul class="simple">
<li><p><a class="reference external" href="http://wiki.ros.org/tf2">tf2</a></p></li>
</ul>
</div>

    <script type="text/javascript">
        function init() {
            WaveDrom.ProcessAll();
        }
        window.onload = init;
    </script>

              </div>
              
              
          </main>
          

      </div>
    </div>

    <script src="../../_static/js/index.js"></script>
    
    <!-- Google Analytics -->
    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-20699788-1', 'auto');
      ga('set', 'anonymizeIp', true);
      ga('send', 'pageview');
    </script>
    <script async src='https://www.google-analytics.com/analytics.js'></script>
    <!-- End Google Analytics -->
    <footer class="footer mt-5 mt-md-0">
  <div class="container">
    <p>
          &copy; Copyright 2004-2020, tschinz.<br/>
        Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.1.0.<br/>
    </p>
  </div>
</footer>
  </body>
</html>