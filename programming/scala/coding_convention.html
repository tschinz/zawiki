
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Coding Convention &#8212; Zawiki</title>
    
  <link rel="stylesheet" href="../../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/default.js"></script>
    <script src="../../_static/wavedrom.min.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="../../_static/favicon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Libraries" href="libraries.html" />
    <link rel="prev" title="Scala" href="index.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main">
<div class="container-xl">

    <a class="navbar-brand" href="../../index.html">
    
      <img src="../../_static/logo.svg" class="logo" alt="logo" />
    
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-menu" aria-controls="navbar-menu" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar-menu" class="col-lg-9 collapse navbar-collapse">
      <ul id="navbar-main-elements" class="navbar-nav mr-auto">
        
        
        <li class="nav-item ">
            <a class="nav-link" href="../../os/index.html">OS</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../../tools/index.html">Tools</a>
        </li>
        
        <li class="nav-item active">
            <a class="nav-link" href="../index.html">Programming</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../../hw/index.html">Hardware</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../../writing/index.html">Writing</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../../multimedia/index.html">Multimedia</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../../security/index.html">Security</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../../about/index.html">About</a>
        </li>
        
        
        <li class="nav-item">
            <a class="nav-link nav-external" href="https://github.com/tschinz/config">Config repo<i class="fas fa-external-link-alt"></i></a>
        </li>
        
      </ul>


      <form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Don't panic, search" aria-label="Don't panic, search" autocomplete="off" >
</form>
      

      <ul class="navbar-nav">
        
          <li class="nav-item">
            <a class="nav-link" href="https://github.com/tschinz/zawiki" target="_blank" rel="noopener">
              <span><i class="fab fa-github-square"></i></span>
            </a>
          </li>
        
        
          <li class="nav-item">
            <a class="nav-link" href="https://twitter.com/tschinz" target="_blank" rel="noopener">
              <span><i class="fab fa-twitter-square"></i></span>
            </a>
          </li>
        
      </ul>
    </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
          <div class="col-12 col-md-3 bd-sidebar"><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">

    <div class="bd-toc-item active">
    
  
    <ul class="nav bd-sidenav">
        
        
        
        
        
        
          
            
                <li class="">
                    <a href="../general/index.html">General</a>
                </li>
            
          
            
                <li class="">
                    <a href="../ahk/index.html">AHK</a>
                </li>
            
          
            
                <li class="">
                    <a href="../c_cpp/index.html">C / C++</a>
                </li>
            
          
            
                <li class="">
                    <a href="../licenses/index.html">Licenses</a>
                </li>
            
          
            
                <li class="">
                    <a href="../make/index.html">Make</a>
                </li>
            
          
            
                <li class="">
                    <a href="../python/index.html">Python</a>
                </li>
            
          
            
                <li class="">
                    <a href="../regex/index.html">RegEx</a>
                </li>
            
          
            
                <li class="">
                    <a href="../ros/index.html">ROS</a>
                </li>
            
          
            
  
                <li class="active">
                    <a href="index.html">Scala</a>
                    <ul>
                    
                        <li class="active">
                            <a href="">Coding Convention</a>
                        </li>
                    
                        <li class="">
                            <a href="libraries.html">Libraries</a>
                        </li>
                    
                    </ul>
                </li>
            
          
            
                <li class="">
                    <a href="../spinal/index.html">Spinal HDL</a>
                </li>
            
          
            
                <li class="">
                    <a href="../swift/index.html">Swift</a>
                </li>
            
          
            
                <li class="">
                    <a href="../tcl_tk_do/index.html">Tcl-Tk</a>
                </li>
            
          
            
                <li class="">
                    <a href="../vhdl/index.html">VHDL</a>
                </li>
            
          
        
        
        
        
        
        
        
        
        
        
        
        
      </ul>
  
  </nav>
          </div>
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
              
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="nav section-nav flex-column">
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#introduction" class="nav-link">Introduction</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#class-vs-case-class" class="nav-link">class vs case class</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h3">
            <a href="#case-class" class="nav-link">[case] class</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#companion-object" class="nav-link">companion object</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#function" class="nav-link">function</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#instances" class="nav-link">instances</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#if-when" class="nav-link">if / when</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#switch" class="nav-link">switch</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#parameters" class="nav-link">Parameters</a>
        </li>
    
            </ul>
        </li>
    
    </ul>
</nav>



<div class="tocsection editthispage">
    <a href="https://github.com/tschinz/zawiki/edit/master/source/programming/scala/coding_convention.rst">
        <i class="fas fa-pencil-alt"></i> Edit this page
    </a>
</div>

              
          </div>
          

          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <div class="section" id="coding-convention">
<h1>Coding Convention<a class="headerlink" href="#coding-convention" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>The coding conventions used in SpinalHDL are the same as the ones documented in the <a class="reference external" href="https://docs.scala-lang.org/style/">scala doc</a>.</p>
<p>Some additional practical details and cases are explained in next chapters.</p>
</div>
<div class="section" id="class-vs-case-class">
<h2>class vs case class<a class="headerlink" href="#class-vs-case-class" title="Permalink to this headline">¶</a></h2>
<p>When you define a <code class="docutils literal notranslate"><span class="pre">Bundle</span></code> or a <code class="docutils literal notranslate"><span class="pre">Component</span></code>, have a preference to declare them as <code class="docutils literal notranslate"><span class="pre">case</span> <span class="pre">class</span></code>.</p>
<p>The reasons are:</p>
<ul class="simple">
<li><p>It avoids the use of <code class="docutils literal notranslate"><span class="pre">new</span></code> keywords. Never having to use it is better than sometimes under some conditions.</p></li>
<li><p>A <code class="docutils literal notranslate"><span class="pre">case</span> <span class="pre">class</span></code> provides an <code class="docutils literal notranslate"><span class="pre">clone</span></code> function. This is useful in SpinalHDL where there is a need to clone one Bundle. For example, when you define a new <code class="docutils literal notranslate"><span class="pre">Reg</span></code> or a new <code class="docutils literal notranslate"><span class="pre">Stream</span></code> of some kind.</p></li>
<li><p>Construction parameters are directly visible from outside.</p></li>
</ul>
<div class="section" id="case-class">
<h3>[case] class<a class="headerlink" href="#case-class" title="Permalink to this headline">¶</a></h3>
<p>All classes names should start with a <strong>upper case</strong> letter</p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Fifo</span> <span class="k">extends</span> <span class="nc">Component</span> <span class="o">{</span>

<span class="o">}</span>

<span class="k">class</span> <span class="nc">Counter</span> <span class="k">extends</span> <span class="nc">Area</span> <span class="o">{</span>

<span class="o">}</span>

<span class="k">case</span> <span class="k">class</span> <span class="nc">Color</span> <span class="k">extends</span> <span class="nc">Bundle</span> <span class="o">{</span>

<span class="o">}</span>
</pre></div>
</div>
</div>
<div class="section" id="companion-object">
<h3>companion object<a class="headerlink" href="#companion-object" title="Permalink to this headline">¶</a></h3>
<p>A companion object should start with a <strong>upper case</strong> letter.</p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">object</span> <span class="nc">Fifo</span> <span class="o">{</span>
  <span class="k">def</span> <span class="n">apply</span><span class="o">(</span><span class="n">that</span><span class="k">:</span> <span class="kt">Stream</span><span class="o">[</span><span class="kt">Bits</span><span class="o">])</span><span class="k">:</span> <span class="kt">Stream</span><span class="o">[</span><span class="kt">Bits</span><span class="o">]</span> <span class="o">=</span> <span class="o">{...}</span>
<span class="o">}</span>

<span class="k">object</span> <span class="nc">MajorityVote</span> <span class="o">{</span>
  <span class="k">def</span> <span class="n">apply</span><span class="o">(</span><span class="n">that</span><span class="k">:</span> <span class="kt">Bits</span><span class="o">)</span><span class="k">:</span> <span class="kt">UInt</span> <span class="o">=</span> <span class="o">{...}</span>
<span class="o">}</span>
</pre></div>
</div>
<p>An exception to this rule is when the companion object is used as a function (only <code class="docutils literal notranslate"><span class="pre">apply</span></code> inside), and these <code class="docutils literal notranslate"><span class="pre">apply</span></code> functions don’t generate hardware:</p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">object</span> <span class="nc">log2</span><span class="o">{</span>
  <span class="k">def</span> <span class="n">apply</span><span class="o">(</span><span class="n">value</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="o">{...}</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
<div class="section" id="function">
<h3>function<a class="headerlink" href="#function" title="Permalink to this headline">¶</a></h3>
<p>A function should always start with a <strong>lower case</strong> letter:</p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="n">sinTable</span> <span class="o">=</span> <span class="o">(</span><span class="mi">0</span> <span class="n">until</span> <span class="n">sampleCount</span><span class="o">).</span><span class="n">map</span><span class="o">(</span><span class="n">sampleIndex</span> <span class="o">=&gt;</span> <span class="o">{</span>
  <span class="k">val</span> <span class="n">sinValue</span> <span class="o">=</span> <span class="nc">Math</span><span class="o">.</span><span class="n">sin</span><span class="o">(</span><span class="mi">2</span> <span class="o">*</span> <span class="nc">Math</span><span class="o">.</span><span class="nc">PI</span> <span class="o">*</span> <span class="n">sampleIndex</span> <span class="o">/</span> <span class="n">sampleCount</span><span class="o">)</span>
  <span class="n">S</span><span class="o">((</span><span class="n">sinValue</span> <span class="o">*</span> <span class="o">((</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">resolutionWidth</span><span class="o">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="o">)).</span><span class="n">toInt</span><span class="o">,</span> <span class="n">resolutionWidth</span> <span class="n">bits</span><span class="o">)</span>
<span class="o">})</span>

<span class="k">val</span> <span class="n">rom</span> <span class="o">=</span>  <span class="nc">Mem</span><span class="o">(</span><span class="nc">SInt</span><span class="o">(</span><span class="n">resolutionWidth</span> <span class="n">bit</span><span class="o">),</span><span class="n">initialContent</span> <span class="o">=</span> <span class="n">sinTable</span><span class="o">)</span>
</pre></div>
</div>
</div>
<div class="section" id="instances">
<h3>instances<a class="headerlink" href="#instances" title="Permalink to this headline">¶</a></h3>
<p>Instances of classes should always start with a <strong>lower case</strong> letter:</p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">val</span> <span class="n">fifo</span>   <span class="o">=</span> <span class="k">new</span> <span class="nc">Fifo</span><span class="o">()</span>
<span class="k">val</span> <span class="n">buffer</span> <span class="o">=</span> <span class="nc">Reg</span><span class="o">(</span><span class="nc">Bits</span><span class="o">(</span><span class="mi">8</span> <span class="n">bits</span><span class="o">))</span>
</pre></div>
</div>
</div>
<div class="section" id="if-when">
<h3>if / when<a class="headerlink" href="#if-when" title="Permalink to this headline">¶</a></h3>
<p>Scala <code class="docutils literal notranslate"><span class="pre">if</span></code> and SpinalHDL <code class="docutils literal notranslate"><span class="pre">when</span></code> should normally be written in the following way:</p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">if</span><span class="o">(</span><span class="n">cond</span><span class="o">){</span>
  <span class="o">...</span>
<span class="o">}</span> <span class="k">else</span> <span class="k">if</span><span class="o">(</span><span class="n">cond</span><span class="o">){</span>

<span class="o">}</span> <span class="k">else</span> <span class="o">{</span>

<span class="o">}</span>

<span class="n">when</span><span class="o">(</span><span class="n">cond</span><span class="o">){</span>

<span class="o">}.</span><span class="n">elseWhen</span><span class="o">(</span><span class="n">cond</span><span class="o">){</span>

<span class="o">}.</span><span class="n">otherwise</span><span class="o">{</span>

<span class="o">}</span>
</pre></div>
</div>
</div>
<div class="section" id="switch">
<h3>switch<a class="headerlink" href="#switch" title="Permalink to this headline">¶</a></h3>
<p>SpinalHDL switch should normally be written in the following way:</p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">switch</span><span class="o">(</span><span class="n">value</span><span class="o">){</span>
  <span class="n">is</span><span class="o">(</span><span class="n">key</span><span class="o">){</span>

  <span class="o">}</span>
  <span class="n">is</span><span class="o">(</span><span class="n">key</span><span class="o">){</span>

  <span class="o">}</span>
  <span class="n">default</span><span class="o">{</span>

  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
<div class="section" id="parameters">
<h3>Parameters<a class="headerlink" href="#parameters" title="Permalink to this headline">¶</a></h3>
<p>Grouping parameters of a component/bundle inside a case class is in general welcome:</p>
<ul class="simple">
<li><p>Easier to carry/manipulate to configure the design</p></li>
<li><p>Better maintainability</p></li>
</ul>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">case</span> <span class="k">class</span> <span class="nc">RgbConfig</span><span class="o">(</span><span class="n">rWidth</span><span class="k">:</span> <span class="kt">Int</span><span class="o">,</span> <span class="n">gWidth</span><span class="k">:</span> <span class="kt">Int</span><span class="o">,</span> <span class="n">bWidth</span><span class="k">:</span> <span class="kt">Int</span><span class="o">){</span>
  <span class="k">def</span> <span class="n">getWidth</span> <span class="o">=</span> <span class="n">rWidth</span> <span class="o">+</span> <span class="n">gWidth</span> <span class="o">+</span> <span class="n">bWidth</span>
<span class="o">}</span>

<span class="k">case</span> <span class="k">class</span> <span class="nc">Rgb</span><span class="o">(</span><span class="n">c</span><span class="k">:</span> <span class="kt">RgbConfig</span><span class="o">)</span> <span class="k">extends</span> <span class="nc">Bundle</span> <span class="o">{</span>
  <span class="k">val</span> <span class="n">r</span> <span class="o">=</span> <span class="nc">UInt</span><span class="o">(</span><span class="n">c</span><span class="o">.</span><span class="n">rWidth</span> <span class="n">bit</span><span class="o">)</span>
  <span class="k">val</span> <span class="n">g</span> <span class="o">=</span> <span class="nc">UInt</span><span class="o">(</span><span class="n">c</span><span class="o">.</span><span class="n">gWidth</span> <span class="n">bit</span><span class="o">)</span>
  <span class="k">val</span> <span class="n">b</span> <span class="o">=</span> <span class="nc">UInt</span><span class="o">(</span><span class="n">c</span><span class="o">.</span><span class="n">bWidth</span> <span class="n">bit</span><span class="o">)</span>
<span class="o">}</span>
</pre></div>
</div>
<p>But this should not be applied in all cases. For example: in a Fifo, it doesn’t make sense to group the dataType parameter with the depth of the fifo because, in general, the dataType is something related to the design, while the depth is something related to the configuration of the design.</p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Fifo</span><span class="o">[</span><span class="kt">T</span> <span class="k">&lt;:</span> <span class="kt">Data</span><span class="o">](</span><span class="n">dataType</span><span class="k">:</span> <span class="kt">T</span><span class="o">,</span> <span class="n">depth</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span> <span class="k">extends</span> <span class="nc">Component</span> <span class="o">{</span>

<span class="o">}</span>
</pre></div>
</div>
</div>
</div>
</div>

    <script type="text/javascript">
        function init() {
            WaveDrom.ProcessAll();
        }
        window.onload = init;
    </script>

              </div>
              
              
          </main>
          

      </div>
    </div>

    
  <script src="../../_static/js/index.3da636dd464baa7582d2.js"></script>


    
    <!-- Google Analytics -->
    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-20699788-1', 'auto');
      ga('set', 'anonymizeIp', true);
      ga('send', 'pageview');
    </script>
    <script async src='https://www.google-analytics.com/analytics.js'></script>
    <!-- End Google Analytics -->
    <footer class="footer mt-5 mt-md-0">
  <div class="container">
    <p>
          &copy; Copyright 2004-2020, tschinz.<br/>
        Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.3.0.<br/>
    </p>
  </div>
</footer>
  </body>
</html>